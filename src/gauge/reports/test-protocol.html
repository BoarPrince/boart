<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script type="text/javascript" language="javascript" src="https://code.jquery.com/jquery-3.5.1.js"></script>
        <script type="text/javascript" language="javascript" src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
            crossorigin="anonymous"
        />
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
            crossorigin="anonymous"
        ></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" />
        <style type="text/css">
            body {
                background-color: black;
            }
            td {
                vertical-align: middle;
            }
            dd {
                font-size: smaller;
            }
            dd small {
                font-size: smaller;
            }
            dd small pre {
                font-size: smaller;
                font-family: 'Courier New', Courier, monospace;
            }
            dd span.duration {
                position: absolute;
                right: 1em;
                font-size: x-small;
            }
            div[data-bs-toggle] {
                height: 3em;
                padding-top: 1em;
                padding-bottom: 1em;
                margin-top: -1em;
                margin-bottom: -1em;
            }
            #protocol_table tbody tr.failed:hover,
            #protocol_table tbody tr.passed:hover,
            div[data-bs-toggle]:hover {
                opacity: 0.6;
                font-style: italic;
                cursor: pointer;
            }
            td.status,
            div.statistic .badge {
                cursor: pointer;
            }
            td.details-control i {
                font-size: xx-large;
            }
            tr:not(.shown) td.details-control .closed,
            tr.shown td.details-control .opened {
                display: initial;
            }
            tr:not(.shown) td.details-control .opened,
            tr.shown td.details-control .closed {
                display: none;
            }
            tr.group td {
                padding: 20px 10px;
                font-size: xx-large;
            }
            li.step {
                padding: 1rem 0.5rem;
                margin-left: 2rem;
                margin-right: 1rem;
            }
            .step-header i {
                position: absolute;
                left: -2rem;
                font-size: large;
            }
            .output-code,
            .input-code {
                position: relative;
            }
            .code-copy-icon {
                position: absolute;
                top: 0.5rem;
                right: 2rem;
                font-size: x-large;
                color: lightgray;
            }
            .code-copy-icon:hover:active {
                color: green;
            }
            .code-copy-icon:hover {
                color: gray;
                height: 0;
            }
            .card-text pre {
                overflow-x: auto;
                max-height: 25em;
            }
            ul .card:not(:first-child) {
                margin-top: 0.5em;
            }
            ul .card:first-child {
                margin-top: 1em;
            }
            img.screenshot {
                width: 15em;
                cursor: pointer;
            }
        </style>
        <title>Test Report</title>
    </head>
    <body>
        <div class="container-fluid">
            <figure>
                <figcaption>
                    <div class="h1 alert alert-dark" role="alert">Test Protocol (<span class="project-description"></span>)</div>
                </figcaption>
                <div class="alert alert-dark statistic" role="alert">
                    <div class="row p-2 pt-4 pb-4 border-bottom border-dark border-4 fw-bold">
                        <div class="col-2">Time</div>
                        <div class="col-10 start-time"></div>
                        <div class="col-2">Total Duration</div>
                        <div class="col-10"><span class="complete-duration"></span> min</div>
                    </div>
                    <div class="row high p-2 border-bottom border-dark border-4">
                        <div class="col-2 fw-bold">High</div>
                        <div class="col-2">
                            <div class="row-1">
                                <div class="col-12 passed">
                                    <span class="badge bg-success">Succeed</span>
                                    <small class="count"></small>
                                </div>
                                <div class="col-12 failed">
                                    <span class="badge bg-danger">Failed</span>
                                    <small class="count"></small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row medium p-2 border-bottom border-dark border-4">
                        <div class="col-2 fw-bold">Medium</div>
                        <div class="col-2">
                            <div class="row-1">
                                <div class="col-12 passed">
                                    <span class="badge bg-success">Succeed</span>
                                    <small class="count"></small>
                                </div>
                                <div class="col-12 failed">
                                    <span class="badge bg-danger">Failed</span>
                                    <small class="count"></small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row low p-2">
                        <div class="col-2 fw-bold">Low</div>
                        <div class="col-2">
                            <div class="row-1">
                                <div class="col-12 passed">
                                    <span class="badge bg-success">Succeed</span>
                                    <small class="count"></small>
                                </div>
                                <div class="col-12 failed">
                                    <span class="badge bg-danger">Failed</span>
                                    <small class="count"></small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <table id="protocol_table" class="table table-dark table-striped" style="width: 100%">
                    <thead>
                        <tr>
                            <td></td>
                            <th scope="col">Test Group</th>
                            <th scope="col">Test</th>
                            <th scope="col">Status</th>
                            <th scope="col">Ticket</th>
                            <th scope="col">Priority</th>
                            <th scope="col">Duration</th>
                        </tr>
                    </thead>
                </table>
            </figure>
        </div>
        <!-- ##################################################### -->
        <!-- Render Table -->
        <!-- ##################################################### -->
        <script>
            const groupColumn = 1;
            $(document).ready(function () {
                const table = $('#protocol_table').DataTable({
                    paging: false,
                    searching: false,
                    ordering: false,
                    info: false,
                    autoWidht: true,
                    columns: [
                        {
                            data: '',
                            className: 'details-control',
                            orderable: false,
                            render: (data, type, row, meta) => {
                                const textClass = row.status == 'failed' ? 'text-danger' : 'text-success';
                                return `<button type="button" class="btn btn-outline-secondary border-0"><i class="${textClass} closed bi bi-plus-circle-fill"></i><i class="${textClass} opened bi bi-dash-circle-fill"></i></button>`;
                            }
                        },
                        { data: 'topic' },
                        { data: 'name' },
                        {
                            data: 'status',
                            className: 'status',
                            render: (data, type, row, meta) =>
                                data == 'failed'
                                    ? `<span class="badge bg-danger">${data}</span>`
                                    : `<span class="badge bg-success">${data}</span>`
                        },
                        { data: 'ticket' },
                        { data: 'priority' },
                        {
                            data: 'duration',
                            render: (data, type, row, meta) => `<small>${formatDuration(data)} s</small>`
                        }
                    ],
                    createdRow: function (row, data, dataIndex, cells) {
                        $(row).addClass(data.status);
                        $(row).addClass(`local-${data.localId}`);
                    },
                    order: [[0, 'asc']],
                    columnDefs: [{ visible: false, targets: groupColumn }],
                    drawCallback: function (settings) {
                        var api = this.api();
                        var rows = api.rows({ page: 'current' }).nodes();
                        var last = null;
                        var data = api.data();

                        api.column(groupColumn, { page: 'current' })
                            .data()
                            .each((group, i) => {
                                if (last !== group) {
                                    $(rows)
                                        .eq(i)
                                        .before(`<tr local-id="${data[i].localId}" class="group"><td colspan="7">${group}</td></tr>`);

                                    last = group;
                                }
                            });
                    },
                    data: document.data.overview
                });

                // #####################################################
                // Add event listener for opening and closing details
                // #####################################################
                $('#protocol_table tbody').on('click', 'tr', function () {
                    const tr = $(this);
                    const data = table.data();
                    const row = table.row(tr);
                    if (row.child.isShown()) {
                        // This row is already open - close it
                        row.child.hide();
                        tr.removeClass('shown');
                    } else {
                        const data = row.data();
                        if (!data) {
                            const localId = tr.attr('local-id');
                            const rows = $(`.local-${localId}`);
                            if (tr.hasClass('hide')) {
                                rows.show();
                                tr.removeClass('hide');
                            } else {
                                rows.hide();
                                tr.addClass('hide');
                            }
                            return;
                        }
                        const scenario = document.data.tests[data.testId];
                        document.scenarioDatailPostActions = [];
                        const childContent = document.formTestDetail(scenario);
                        row.child(childContent).show();
                        document.scenarioDatailPostActions.forEach((action) => action());
                        tr.addClass('shown');
                    }
                });

                // #####################################################
                // Filters
                // #####################################################
                const filterTableByPrioAndStatus = (priority, status) => {
                    table.clear().draw();
                    const failedTests = document.data.overview.filter((test) => test.status == status && test.priority == priority);
                    failedTests.forEach((test) => table.row.add(test).draw(false));
                };

                globalThis.filterTableByTag = (tag) => {
                    table.clear().draw();
                    const failedTests = document.data.overview.filter((test) => test.tags?.includes(tag));
                    failedTests.forEach((test) => table.row.add(test).draw(false));
                    return false;
                };

                $('.project-description').text(`${document.data.projectName}, ${document.data.environment}`);

                // #####################################################
                // Add Statistic
                // #####################################################
                const statistic = document.data.statistic;
                $('.statistic .high .passed .count').text(`(${statistic.high.succeed})`);
                $('.statistic .high .failed .count').text(`(${statistic.high.failed})`);
                $('.statistic .medium .passed .count').text(`(${statistic.medium.succeed})`);
                $('.statistic .medium .failed .count').text(`(${statistic.medium.failed})`);
                $('.statistic .low .passed .count').text(`(${statistic.low.succeed})`);
                $('.statistic .low .failed .count').text(`(${statistic.low.failed})`);

                $('div.statistic').on('click', '.high .passed', () => filterTableByPrioAndStatus('high', 'passed'));
                $('div.statistic').on('click', '.high .failed', () => filterTableByPrioAndStatus('high', 'failed'));
                $('div.statistic').on('click', '.medium .passed', () => filterTableByPrioAndStatus('medium', 'passed'));
                $('div.statistic').on('click', '.medium .failed', () => filterTableByPrioAndStatus('medium', 'failed'));
                $('div.statistic').on('click', '.low .passed', () => filterTableByPrioAndStatus('low', 'passed'));
                $('div.statistic').on('click', '.low .failed', () => filterTableByPrioAndStatus('low', 'failed'));

                $('.start-time').text(formatDate(document.data.startTime));
                $('.complete-duration').text(formatDuration(document.data.durationMin));
            });
        </script>

        <script>
            // #####################################################
            // Copy code to clipboard
            // #####################################################
            function copyCodeToClipboard(self, code) {
                //self.style.color = 'red';
                if (!navigator.clipboard) {
                    return;
                }
                navigator.clipboard.writeText(code);
            }
            // #####################################################
            // Helpers
            // #####################################################
            const stringifyIfObject = (data) => {
                if (typeof data === 'object') {
                    return JSON.stringify(data, null, ' ');
                }
                return data;
            };

            const formatDuration = (duration) => {
                return new Intl.NumberFormat({ maximumSignificantDigits: 2 }).format(duration);
            };

            const formatDate = (dateISO) => {
                const date = new Date(dateISO);
                return new Intl.DateTimeFormat('default', { dateStyle: 'full', timeStyle: 'long' }).format(date);
            };

            // #####################################################
            // Step Details
            // #####################################################
            const addStepDetails = (step) => {
                const stepDetail = [];

                // screenshots
                if (!!step.screenshots && step.screenshots.length > 0) {
                    stepDetail.push(`<div class="card">
                        <p class="card-header">Screenshots</p>
                        <div class="card-body input-code">`);

                    step.screenshots.forEach((screenshot) => {
                        stepDetail.push(`<img class="screenshot" id="img-${screenshot}" loading="lazy"></img>`);
                        document.scenarioDatailPostActions.push(() => {
                            const image = $(`#img-${screenshot}`);
                            image
                                .on('load', function () {
                                    this.src = document.data.screenshots[screenshot];
                                    image.unbind('load');
                                })
                                .on('click', function () {
                                    let pdfWindow = window.open('');
                                    pdfWindow.document.write(
                                        "<img width='100%' height='100%' src='" + document.data.screenshots[screenshot] + "'></img>"
                                    );
                                })
                                .each(function () {
                                    $(this).trigger('load');
                                });
                            $(`#img-${screenshot}`).removeAttr('id');
                        });
                    });
                    stepDetail.push(`</div></div>`);
                }

                // Input
                step.input.forEach((stepInput) => {
                    const code = stringifyIfObject(stepInput.data) || '-';
                    stepDetail.push(`<div class="card">
                                        <p class="card-header">${stepInput.desc}</p>
                                        <div class="card-body input-code">
                                            <div class="card-text">
                                                <i id="ic-${stepInput.id}" class="code-copy-icon bi bi-file-earmark-text-fill"></i>
                                                <small><pre>${code}</pre></small></div>
                                        </div>
                                     </div>`);
                    document.scenarioDatailPostActions.push(() => {
                        $(`#ic-${stepInput.id}`).on('click', function () {
                            copyCodeToClipboard(this, code);
                        });
                        $(`#ic-${stepInput.id}`).removeAttr('id');
                    });
                });

                // Output
                step.output
                    .filter((stepOutput) => !!stepOutput.desc)
                    .forEach((stepOutput) => {
                        const code = stringifyIfObject(stepOutput.data);
                        stepDetail.push(`<div class="card">
                            <p class="card-header">${stepOutput.desc}</p>
                                <div class="card-body output-code">
                                    <div class="card-text">
                                        <i id="oc-${stepOutput.id}" class="code-copy-icon bi bi-file-earmark-text-fill"></i>
                                        <small><pre>${code}</pre></small></div>
                                </div>
                            </div>`);
                        document.scenarioDatailPostActions.push(() => {
                            $(`#oc-${stepOutput.id}`).on('click', function () {
                                copyCodeToClipboard(this, code);
                            });
                            $(`#oc-${stepOutput.id}`).removeAttr('id');
                        });
                    });

                // Error Message
                if (!!step.errorMessage) {
                    stepDetail.push(`<div class="card">
                                        <p class="card-header">Error Message</p>
                                        <div class="card-body">
                                            <div class="card-text"><small>${stringifyIfObject(step.errorMessage)}</small></div>
                                        </div>
                                      </div>`);
                }
                return stepDetail.join('\n');
            };

            // #####################################################
            // Step List
            // #####################################################
            const addSteps = (steps) => {
                const stepDescItems = [];
                stepDescItems.push('<ul class="list-group">');
                steps.forEach((step) => {
                    stepDescItems.push(`<li class="list-group-item list-group-item-dark step">`);
                    stepDescItems.push(`<div class="step-header" data-bs-toggle="collapse" href="#detail-${step.id}">`);

                    switch (step.status) {
                        case 'failed':
                            stepDescItems.push('<i class="text-danger bi bi-emoji-frown-fill"></i>');
                            break;
                        case 'succeed':
                            stepDescItems.push('<i class="text-success bi bi-emoji-smile-fill"></i>');
                            break;
                        default:
                            stepDescItems.push('<i class="text-secondary bi bi-emoji-neutral-fill"></i>');
                    }

                    stepDescItems.push(`${step.description}`);
                    stepDescItems.push(`<span class="duration">${formatDuration(step.duration)} s</span>`);
                    stepDescItems.push('</div>');

                    stepDescItems.push(`<div class="collapse" id="detail-${step.id}">`);
                    stepDescItems.push(addStepDetails(step));
                    stepDescItems.push(`</div>`);

                    stepDescItems.push('</li>');
                });
                stepDescItems.push('</ul>');
                return stepDescItems.join('\n');
            };
            const conditinallyAdd = (text_or_delegate, condition) => {
                return condition ? (typeof text_or_delegate === 'string' ? text_or_delegate : text_or_delegate()) : '';
            };

            // #####################################################
            // Test Detail
            // #####################################################
            document.formTestDetail = (test) => {
                return (
                    '<div class="container">' +
                    // Execution Time
                    '<dl class="row">' +
                    ' <dt class="col-2">Time</dt>' +
                    `  <dd class="col-10">${formatDate(test.startTime)}</dd>` +
                    '</dl>' +
                    // Duration
                    '<dl class="row">' +
                    ' <dt class="col-2">Duration</dt>' +
                    `  <dd class="col-10">${formatDuration(test.duration)} s</dd>` +
                    '</dl>' +
                    conditinallyAdd(
                        // Tickets
                        '<dl class="row">' +
                            ' <dt class="col-2">Tickets</dt>' +
                            `  <dd class="col-10">${test.tickets
                                .map((t) => '<a href="' + t.link + '" target="_">' + t.id + '@' + t.source + '</a>')
                                .join(', ')}</dd>` +
                            '</dl>',
                        !!test.tickets && test.tickets.length > 0
                    ) +
                    conditinallyAdd(
                        // Tags
                        '<dl class="row">' +
                            ' <dt class="col-2">Tags</dt>' +
                            `  <dd class="col-10">${test.tags
                                .map((t) => `<a href="#" onclick="filterTableByTag('${t}');">${t}</a>`)
                                .join(', ')}</dd>` +
                            '</dl>',
                        !!test.tags && test.tags.length > 0
                    ) +
                    conditinallyAdd(
                        // Description
                        '<dl class="row">' +
                            ' <dt class="col-2">Description</dt>' +
                            `  <dd class="col-10">${test.descriptions.replace('\n', '<br>')}</dd>` +
                            '</dl>',
                        !!test.descriptions
                    ) +
                    conditinallyAdd(
                        () =>
                            // stepDescription
                            '<dl class="row">' +
                            ' <dt class="col-2">Steps</dt>' +
                            `  <dd class="col-10">${addSteps(test.steps)}</dd>` +
                            '</dl>',
                        !!test.steps && test.steps.length > 0
                    ) +
                    conditinallyAdd(
                        // Failure Description
                        '<dl class="row">' +
                            ' <dt class="col-2">Failure</dt>' +
                            `  <dd class="col-10"><pre>${test.errorMessage}</pre></dd>` +
                            '</dl>',
                        test.status == 'failed' && !!test.errorMessage
                    ) +
                    conditinallyAdd(
                        // screenshot
                        '<dl class="row">' +
                            ' <dt class="col-2">Screenshot</dt>' +
                            `  <dd class="col-10"><img width="100%" src="${test.screenshot}" alt="Red dot" /></dd>` +
                            '</dl>',
                        !!test.screenshot
                    ) +
                    '</div>'
                );
            };
        </script>
        <!-- ##################################################### -->
        <!-- Document Data -->
        <!-- ##################################################### -->
        <script>
            document.data = {
                statistic: { high: { succeed: 0, failed: 0 }, medium: { succeed: 1, failed: 0 }, low: { succeed: 0, failed: 0 } },
                overview: [
                    {
                        topic: '1. Getting Started with Gauge',
                        name: '1.2. Second test',
                        ticket: '',
                        tags: ['scenario2', 'spec1'],
                        status: 'succeed',
                        priority: 'medium',
                        duration: 0.95,
                        startTime: '2022-09-15T13:12:19.736Z',
                        localId: '5db5ea5d-9282-4041-8632-b0bba7f7d3cf',
                        testId: '88c7401b-fba1-4d8b-9de0-0ad212060467'
                    }
                ],
                locals: {
                    '5db5ea5d-9282-4041-8632-b0bba7f7d3cf': {
                        id: '5db5ea5d-9282-4041-8632-b0bba7f7d3cf',
                        tags: ['spec1'],
                        duration: 1,
                        status: 'succeed',
                        name: 'Getting Started with Gauge',
                        number: '1'
                    }
                },
                tests: {
                    '0b2aa64f-4f2f-4dc2-8a08-9e51573582af': {
                        id: '0b2aa64f-4f2f-4dc2-8a08-9e51573582af',
                        tags: ['scenario1', 'spec1'],
                        name: '1.1. First test',
                        status: 'succeed',
                        duration: 0.02,
                        startTime: '2022-09-15T13:12:19.706Z',
                        tickets: [],
                        steps: []
                    },
                    '88c7401b-fba1-4d8b-9de0-0ad212060467': {
                        id: '88c7401b-fba1-4d8b-9de0-0ad212060467',
                        tags: ['scenario2', 'spec1'],
                        name: '1.2. Second test',
                        status: 'succeed',
                        duration: 0.95,
                        startTime: '2022-09-15T13:12:19.736Z',
                        priority: 'medium',
                        descriptions: 'This is a test description',
                        tickets: [],
                        steps: [
                            {
                                id: 'b2b479cc-3090-441d-b528-83dda30a84d8',
                                status: 'succeed',
                                errorMessage: '',
                                duration: 0.93,
                                startTime: '2022-09-15T13:12:19.755Z',
                                type: 'restAuthorize',
                                description: 'asdfafasdfads',
                                input: [
                                    {
                                        id: '-',
                                        desc: 'Rest authorize (config)',
                                        data: {
                                            url: 'https://keycloak.dev.jitpay.eu/auth/realms/jitpay/protocol/openid-connect/token',
                                            grantType: 'password',
                                            retryCount: 2,
                                            retryPause: 5,
                                            clientId: 'jitfleet_portal',
                                            clientSecret: '',
                                            scope: 'openid locations_api fleet_profile fleet_role fleet_apiscope app_api jitpay.role fleet_apiscope email idgen_api ds_api mobilefileagg_api',
                                            username: 'demo@jitpay.eu',
                                            password: 'demoJITpay#123'
                                        }
                                    }
                                ],
                                output: [
                                    {
                                        id: '-',
                                        desc: 'Rest authorize (token)',
                                        data: 'eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJ2X0FjVnoyaU4tSnZ1eldsZVh1a0RTekpjbVBybE5DLUVYS01ybzBmNktFIn0.eyJleHAiOjE2NjMyNjkxNDAsImlhdCI6MTY2MzI0NzU0MCwianRpIjoiOGJjMTg0NjAtMmNhNC00NWRhLWIxM2UtNDJiMGRiYTAzOThhIiwiaXNzIjoiaHR0cHM6Ly9rZXljbG9hay5kZXYuaml0cGF5LmV1L2F1dGgvcmVhbG1zL2ppdHBheSIsImF1ZCI6WyJmbGVldF9hcGkiLCJsb2NhdGlvbnNfYXBpIiwiYXBwX2FwaSIsImRzX2FwaSIsInRvdXJoaXN0b3J5X2FwaSIsIm1vYmlsZXVzZXJwcm9maWxlX2FwaSIsIm1vYmlsZWZpbGVhZ2dfYXBpIiwiaml0cGF5YXBpIiwiaWRnZW5fYXBpIiwiYWNjb3VudCJdLCJzdWIiOiIxOWM2NGFhMi02ZmM0LTRjNGItYTcwOS0zOTU0ZDczNTdjMTIiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJqaXRmbGVldF9wb3J0YWwiLCJzZXNzaW9uX3N0YXRlIjoiZDQzOGI3ZmUtYzAzYS00MjA5LWFmMGYtZDM5NzM1NzVlNzA4IiwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIkppdHBheUFkbWluIiwib2ZmbGluZV9hY2Nlc3MiLCJDYXJyaWVyQWRtaW4iLCJ1bWFfYXV0aG9yaXphdGlvbiIsIkpwQ29tcGFueUVkaXRvciIsImRlZmF1bHQtcm9sZXMtaml0cGF5Il19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJsb2NhdGlvbnNfYXBpIG1hcHBpbmctYXR0cmlidXRlLXNjb3BlIG1vYmlsZXVzZXJwcm9maWxlX2FwaSB0b3VyaGlzdG9yeV9hcGkgZW1haWwgZmxlZXRfcm9sZSBwcm9maWxlIG1vYmlsZWZpbGVhZ2dfYXBpIGRzX2FwaSBmbGVldF9hcGlzY29wZSBqaXRwYXkucm9sZSBmbGVldF9hcGkgYXBwX2FwaSBvZmZsaW5lX2FjY2VzcyBvcGVuaWQgZmxlZXRfcHJvZmlsZSBpZGdlbl9hcGkiLCJzaWQiOiJkNDM4YjdmZS1jMDNhLTQyMDktYWYwZi1kMzk3MzU3NWU3MDgiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwicm9sZSI6WyJKaXRwYXlBZG1pbiIsIm9mZmxpbmVfYWNjZXNzIiwiQ2FycmllckFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iLCJKcENvbXBhbnlFZGl0b3IiLCJkZWZhdWx0LXJvbGVzLWppdHBheSJdLCJyb2xlSWQiOiIyIiwibGVnaXRpbWF0aW9uU3RhdHVzIjoiTGVnaW1pdGF0aW9uQ29tcGxldGVkIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiZGVtb0BqaXRwYXkuZXUiLCJsb2NhbGUiOiJkZSIsInByaW9yaXR5IjoiMTAwMCIsImdpdmVuX25hbWUiOiJEZW1vIiwiaXNkZWxldGVkIjoiRmFsc2UiLCJ1c2VySWQiOiIzN2JhYjc3My0wMTdmLTRkMjktOTM4ZS1lNjI1OTMzNmQwYTQiLCJkcml2ZXJJZCI6IjIwOSIsIm5hbWUiOiJEZW1vIFVzZXIiLCJzdWJzaWRpYXJ5SWQiOiIyNzQiLCJhY3RpdmF0aW9uQ29kZSI6IjEyMzQ1Njc4IiwiZmlyc3RUaW1lTG9nZ2VkSW4iOiJmYWxzZSIsImZhbWlseV9uYW1lIjoiVXNlciIsImVtYWlsIjoiZGVtb0BqaXRwYXkuZXUiLCJ1c2VybmFtZSI6ImRlbW9Aaml0cGF5LmV1In0.cEzIamPLSd9_4FrxAKnKXO34zb84adSFzG22Yl8C79Rw0OCCKT2rI8H5ZP9R0FtXZFEQMjxjfc0lDpYyiQ-jXWq3q8uqYPT7y4pS8cX8N3nIQpv_yK0LktObXe0EeJQnx5QeUHuYi3JEmcwujx85Gtz5nDZAN1JfhbTnUKqyZ4xmDpkoSJQKtqwy-CFVoo0y3FVEBsWcemvY0a8-caxU86azr1Y6ioCTCxeviQNkF0iglzWcAHaf5BCPort8Ppk5AUQXJbZ-v6cEMk5LyOOLj--J7X_ylLEpFoSRZVRbGmjCcXWgSe5iLZ5xci__eV_mSoxPSPrRsIz1JgjKhVgeCQ'
                                    },
                                    {
                                        id: '-',
                                        desc: 'Rest authorize (decoded)',
                                        data: '{"exp":1663269140,"iat":1663247540,"jti":"8bc18460-2ca4-45da-b13e-42b0dba0398a","iss":"https://keycloak.dev.jitpay.eu/auth/realms/jitpay","aud":["fleet_api","locations_api","app_api","ds_api","tourhistory_api","mobileuserprofile_api","mobilefileagg_api","jitpayapi","idgen_api","account"],"sub":"19c64aa2-6fc4-4c4b-a709-3954d7357c12","typ":"Bearer","azp":"jitfleet_portal","session_state":"d438b7fe-c03a-4209-af0f-d3973575e708","realm_access":{"roles":["JitpayAdmin","offline_access","CarrierAdmin","uma_authorization","JpCompanyEditor","default-roles-jitpay"]},"resource_access":{"account":{"roles":["manage-account","manage-account-links","view-profile"]}},"scope":"locations_api mapping-attribute-scope mobileuserprofile_api tourhistory_api email fleet_role profile mobilefileagg_api ds_api fleet_apiscope jitpay.role fleet_api app_api offline_access openid fleet_profile idgen_api","sid":"d438b7fe-c03a-4209-af0f-d3973575e708","email_verified":true,"role":["JitpayAdmin","offline_access","CarrierAdmin","uma_authorization","JpCompanyEditor","default-roles-jitpay"],"roleId":"2","legitimationStatus":"LegimitationCompleted","preferred_username":"demo@jitpay.eu","locale":"de","priority":"1000","given_name":"Demo","isdeleted":"False","userId":"37bab773-017f-4d29-938e-e6259336d0a4","driverId":"209","name":"Demo User","subsidiaryId":"274","activationCode":"12345678","firstTimeLoggedIn":"false","family_name":"User","email":"demo@jitpay.eu","username":"demo@jitpay.eu"}'
                                    },
                                    {
                                        id: '-',
                                        desc: 'Rest authorize (header)',
                                        data: {
                                            retries: 1,
                                            duration: 0.92,
                                            decoded: {
                                                exp: 1663269140,
                                                iat: 1663247540,
                                                jti: '8bc18460-2ca4-45da-b13e-42b0dba0398a',
                                                iss: 'https://keycloak.dev.jitpay.eu/auth/realms/jitpay',
                                                aud: [
                                                    'fleet_api',
                                                    'locations_api',
                                                    'app_api',
                                                    'ds_api',
                                                    'tourhistory_api',
                                                    'mobileuserprofile_api',
                                                    'mobilefileagg_api',
                                                    'jitpayapi',
                                                    'idgen_api',
                                                    'account'
                                                ],
                                                sub: '19c64aa2-6fc4-4c4b-a709-3954d7357c12',
                                                typ: 'Bearer',
                                                azp: 'jitfleet_portal',
                                                session_state: 'd438b7fe-c03a-4209-af0f-d3973575e708',
                                                realm_access: {
                                                    roles: [
                                                        'JitpayAdmin',
                                                        'offline_access',
                                                        'CarrierAdmin',
                                                        'uma_authorization',
                                                        'JpCompanyEditor',
                                                        'default-roles-jitpay'
                                                    ]
                                                },
                                                resource_access: {
                                                    account: { roles: ['manage-account', 'manage-account-links', 'view-profile'] }
                                                },
                                                scope: 'locations_api mapping-attribute-scope mobileuserprofile_api tourhistory_api email fleet_role profile mobilefileagg_api ds_api fleet_apiscope jitpay.role fleet_api app_api offline_access openid fleet_profile idgen_api',
                                                sid: 'd438b7fe-c03a-4209-af0f-d3973575e708',
                                                email_verified: true,
                                                role: [
                                                    'JitpayAdmin',
                                                    'offline_access',
                                                    'CarrierAdmin',
                                                    'uma_authorization',
                                                    'JpCompanyEditor',
                                                    'default-roles-jitpay'
                                                ],
                                                roleId: '2',
                                                legitimationStatus: 'LegimitationCompleted',
                                                preferred_username: 'demo@jitpay.eu',
                                                locale: 'de',
                                                priority: '1000',
                                                given_name: 'Demo',
                                                isdeleted: 'False',
                                                userId: '37bab773-017f-4d29-938e-e6259336d0a4',
                                                driverId: '209',
                                                name: 'Demo User',
                                                subsidiaryId: '274',
                                                activationCode: '12345678',
                                                firstTimeLoggedIn: 'false',
                                                family_name: 'User',
                                                email: 'demo@jitpay.eu',
                                                username: 'demo@jitpay.eu'
                                            },
                                            url: 'https://keycloak.dev.jitpay.eu/auth/realms/jitpay/protocol/openid-connect/token',
                                            option: {
                                                method: 'POST',
                                                body: {
                                                    grant_type: 'password',
                                                    client_id: 'jitfleet_portal',
                                                    response_type: 'code id_token token',
                                                    scope: 'openid locations_api fleet_profile fleet_role fleet_apiscope app_api jitpay.role fleet_apiscope email idgen_api ds_api mobilefileagg_api',
                                                    username: 'demo@jitpay.eu',
                                                    password: 'demoJITpay#123'
                                                },
                                                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                                                mode: 'no-cors',
                                                referrerPolicy: 'unsafe-url'
                                            }
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                projectName: 'gauge',
                durationMin: '0.02',
                startTime: '2022-09-15T13:12:19.681Z'
            };
        </script>
    </body>
</html>
